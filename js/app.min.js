(function(b) { b.textAlign = function(c, d, f, g) { d = d || {}; var h = this.internal.getFontSize(),
            j = this.internal.pageSize.width,
            k = this.getStringUnitWidth(c) * h / this.internal.scaleFactor; "center" === d.align ? f = (j - k) / 2 : "centerAtX" === d.align ? f -= k / 2 : "right" === d.align && (f -= k), this.text(c, f, g) }, b.getLineHeight = function() { return this.internal.getLineHeight() } })(jsPDF.API),
function() { "use strict";
    $("#zt500-image").attr("src", "assets/img/sinottiche/zt500.z3.3.png?timeId=" + new Date().getTime()), $("#zt500-image-lightbox").attr("href", "assets/img/sinottiche/zt500.z3.3.png?timeId=" + new Date().getTime()), $("#zt850-image").attr("src", "assets/img/sinottiche/zt850.z3.3.png?timeId=" + new Date().getTime()), $("#zt850-image-lightbox").attr("href", "assets/img/sinottiche/zt850.z3.3.png?timeId=" + new Date().getTime()), $("#t2max-image").attr("src", "assets/img/sinottiche/t2max.z2.1.png?timeId=" + new Date().getTime()), $("#t2max-image-lightbox").attr("href", "assets/img/sinottiche/t2max.z2.1.png?timeId=" + new Date().getTime()), $("#wind10-image").attr("src", "assets/img/sinottiche/wind10.z2.5.png?timeId=" + new Date().getTime()), $("#wind10-image-lightbox").attr("href", "assets/img/sinottiche/wind10.z2.5.png?timeId=" + new Date().getTime()), $("#rh2mz3_11-image").attr("src", "assets/img/vento_umidita/rh2mz3_11.png?timeId=" + new Date().getTime()), $("#rh2mz3_11-image-lightbox").attr("href", "assets/img/vento_umidita/rh2mz3_11.png?timeId=" + new Date().getTime()), $("#rh2mz3_14-image").attr("src", "assets/img/vento_umidita/rh2mz3_14.png?timeId=" + new Date().getTime()), $("#rh2mz3_14-image-lightbox").attr("href", "assets/img/vento_umidita/rh2mz3_14.png?timeId=" + new Date().getTime()), $("#rh2mz3_17-image").attr("src", "assets/img/vento_umidita/rh2mz3_17.png?timeId=" + new Date().getTime()), $("#rh2mz3_17-image-lightbox").attr("href", "assets/img/vento_umidita/rh2mz3_17.png?timeId=" + new Date().getTime()), $("#rh2mz3_20-image").attr("src", "assets/img/vento_umidita/rh2mz3_20.png?timeId=" + new Date().getTime()), $("#rh2mz3_20-image-lightbox").attr("href", "assets/img/vento_umidita/rh2mz3_20.png?timeId=" + new Date().getTime()), waitingDialog.show("In caricamento...", { dialogSize: "sm", progressType: "info" }); var b = new XMLHttpRequest;
    b.open("GET", "../../aib_bollettino/assets/img/sinottiche/OKFILE.all_ecm_3km?timeId=" + new Date().getTime(), !0), b.onreadystatechange = function() { if (b.readyState === XMLHttpRequest.DONE && 200 === b.status) { moment().locale("it"), moment.updateLocale("it", { months: ["Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"], weekdays: "Domenica_Luned\xEC_Marted\xEC_Mercoled\xEC_Gioved\xEC_Venerd\xEC_Sabato".split("_") }); for (var c = b.responseText, d = /<p>/gi, f = /<\/p>/gi, g = [], h = []; d.exec(c);) g.push(d.lastIndex); for (; f.exec(c);) h.push(f.lastIndex); var j = c.substring(g[1], h[1] - 4);
            document.getElementById("sinottica-text").innerHTML = j; var k = c.substring(0, 4),
                l = c.substring(4, 6),
                m = c.substring(6, 8),
                n = k + "-" + l + "-" + m,
                o = moment(n),
                p = o.clone().subtract(1, "day").format("YYYY-MM-DD");
            document.getElementById("fwi-title").innerHTML += moment(n).format("dddd, Do MMMM YYYY"), document.getElementById("umidita-title").innerHTML += moment(p).format("dddd, Do MMMM YYYY"), document.getElementById("bollettino-title-giorno").innerHTML = moment(n).format("dddd, Do MMMM YYYY"), $("#ffwi-image-lightbox").attr("href", "http://geoportale.lamma.rete.toscana.it/cgi-bin/wms_rischio_prev?map=wms_" + k + "/ris_prev_incendio_wms_" + n + ".map&service=WMS&version=1.1.0&request=GetMap&layers=Comuni_Rfwi_Run0_" + n + ",Comuni&styles=default&bbox=548174.875,4670721.0,787174.875,4933721.0&width=465&height=512&srs=EPSG:32632&format=image/png"), $("#ffwi-image").attr("src", "http://geoportale.lamma.rete.toscana.it/cgi-bin/wms_rischio_prev?map=wms_" + k + "/ris_prev_incendio_wms_" + n + ".map&service=WMS&version=1.1.0&request=GetMap&layers=Comuni_Rfwi_Run0_" + n + ",Comuni&styles=default&bbox=548174.875,4670721.0,787174.875,4933721.0&width=465&height=512&srs=EPSG:32632&format=image/png"), $("#umidita-image-lightbox").attr("href", "http://geoportale.lamma.rete.toscana.it/cgi-bin/wms_datimeteo?map=wms_" + k + "/datimeteo_wms_" + p + ".map&service=WMS&version=1.1.0&request=GetMap&layers=Umid_maxur_sp_" + p + ",Comuni&styles=default&bbox=548174.875,4670721.0,787174.875,4933721.0&width=465&height=512&srs=EPSG:32632&format=image/png"), $("#umidita-image").attr("src", "http://geoportale.lamma.rete.toscana.it/cgi-bin/wms_datimeteo?map=wms_" + k + "/datimeteo_wms_" + p + ".map&service=WMS&version=1.1.0&request=GetMap&layers=Umid_maxur_sp_" + p + ",Comuni&styles=default&bbox=548174.875,4670721.0,787174.875,4933721.0&width=465&height=512&srs=EPSG:32632&format=image/png"); var u = 210,
                v = 0,
                w = u - 2 * v,
                z, B, C, D, E = 10,
                G = $("#pdf_preview"),
                H = $("#flyer_download_btn");
            $(".dropdown-menu li a").click(function() { var wa = $(this).parents(".dropdown").find(".btn");
                wa.html($(this).text() + " <span class=\"caret\"></span>"), wa.val($(this).data("value")) }); var I = function(wa) { return /^#/.test(wa) && (wa = wa.substr(1)), 3 === wa.length && (wa = wa.replace(/\w/, function(xa) { return xa + "" + (xa + "") })), { red: parseInt(wa.substr(0, 2), 16), green: parseInt(wa.substr(2, 2), 16), blue: parseInt(wa.substr(4, 2), 16) } },
                J = function(wa) { return 25.4 * (wa / 72) },
                K = function(wa) { return 72 * (wa / 25.4) },
                L = function(wa, xa, ya) { if (ya > w && (ya = w), K(ya) > wa) throw "The `img_mm_w` parameter is too big"; var za = Math.round(J(xa) * ya / J(wa)); return { w: ya, h: za, centered_x: (u - ya) / 2 } }; try {
                function wa(xa, ya, za, Aa) { var Ba = new Image;
                    ta++, Ba.crossOrigin = "Anonymous", Ba.onload = function() { var Ca = this.id,
                            Da = document.createElement("canvas"),
                            Ea = Da.getContext("2d"),
                            Fa, Ga;
                        Ga = this, Da.width = this.width, "zt500_img" === Ca || "zt850_img" === Ca ? (Da.height = this.height - 200, Ea.drawImage(this, 0, 80, this.width, this.height, 0, 0, this.width, this.height)) : "rh2mz3_11_img" === Ca || "rh2mz3_14_img" === Ca || "rh2mz3_17_img" === Ca || "rh2mz3_20_img" === Ca ? (Da.height = this.height - 122, Ea.drawImage(this, 0, 48, this.width, this.height, 0, 0, this.width, this.height)) : "t2max_img" === Ca || "wind10_img" === Ca ? (Da.height = this.height - 122, Ea.drawImage(this, 0, 38, this.width, this.height, 0, 0, this.width, this.height)) : (Da.height = this.height, Ea.drawImage(this, 0, 0)), Fa = Da.toDataURL(za), ua(), ya(Fa, Ga), Da = null }, Ba.src = xa, Ba.id = Aa } var M = $("#zt500-image").attr("src"),
                    O = $("#zt850-image").attr("src"),
                    Q = $("#t2max-image").attr("src"),
                    S = $("#wind10-image").attr("src"),
                    U = $("#rh2mz3_11-image").attr("src"),
                    V = $("#rh2mz3_14-image").attr("src"),
                    W = $("#rh2mz3_17-image").attr("src"),
                    X = $("#rh2mz3_20-image").attr("src"),
                    Z = $("#ffwi-image").attr("src"),
                    _ = $("#legend-ffwi").attr("src"),
                    aa = $("#umidita-image").attr("src"),
                    ba = $("#legend-umidita").attr("src"),
                    ca = null,
                    da = null,
                    ea = null,
                    fa = null,
                    ga = null,
                    ha = null,
                    ia = null,
                    ja = null,
                    ka = null,
                    la = null,
                    ma = null,
                    na = null,
                    oa = null,
                    pa = null,
                    qa = null,
                    ra = null,
                    sa = null,
                    ta = 0,
                    ua = function() { ta--, 0 === ta && (H.prop("disabled", !1), waitingDialog.hide()) };
                wa(M, function(xa, ya) { ca = { type: "PNG" }, ca.src = xa, ca.w = ya.width, ca.h = ya.height - 200 }, void 0, "zt500_img"), wa("assets/img/sinottiche/zt500_legend.png", function(xa, ya) { da = { type: "PNG" }, da.src = xa, da.w = ya.width, da.h = ya.height }, void 0, "zt500_img_legend"), wa(O, function(xa, ya) { ea = { type: "PNG" }, ea.src = xa, ea.w = ya.width, ea.h = ya.height - 200 }, void 0, "zt850_img"), wa("assets/img/sinottiche/zt850_legend.png", function(xa, ya) { fa = { type: "PNG" }, fa.src = xa, fa.w = ya.width, fa.h = ya.height }, void 0, "zt850_img_legend"), wa(Q, function(xa, ya) { ga = { type: "PNG" }, ga.src = xa, ga.w = ya.width, ga.h = ya.height - 122 }, void 0, "t2max_img"), wa("assets/img/sinottiche/t2max_legend.png", function(xa, ya) { ha = { type: "PNG" }, ha.src = xa, ha.w = ya.width, ha.h = ya.height }, void 0, "t2max_img_legend"), wa(S, function(xa, ya) { ia = { type: "PNG" }, ia.src = xa, ia.w = ya.width, ia.h = ya.height - 122 }, void 0, "wind10_img"), wa("assets/img/sinottiche/wind10_legend.png", function(xa, ya) { ja = { type: "PNG" }, ja.src = xa, ja.w = ya.width, ja.h = ya.height }, void 0, "wind10_img_legend"), wa(U, function(xa, ya) { ka = { type: "PNG" }, ka.src = xa, ka.w = ya.width, ka.h = ya.height - 122 }, void 0, "rh2mz3_11_img"), wa(V, function(xa, ya) { la = { type: "PNG" }, la.src = xa, la.w = ya.width, la.h = ya.height - 122 }, void 0, "rh2mz3_14_img"), wa(W, function(xa, ya) { ma = { type: "PNG" }, ma.src = xa, ma.w = ya.width, ma.h = ya.height - 122 }, void 0, "rh2mz3_17_img"), wa(X, function(xa, ya) { na = { type: "PNG" }, na.src = xa, na.w = ya.width, na.h = ya.height - 122 }, void 0, "rh2mz3_20_img"), wa("assets/img/vento_umidita/rh2mz3_legend.png", function(xa, ya) { oa = { type: "PNG" }, oa.src = xa, oa.w = ya.width, oa.h = ya.height }, void 0, "rh2mz3_img_legend"), wa(Z, function(xa, ya) { pa = { type: "PNG" }, pa.src = xa, pa.w = ya.width, pa.h = ya.height }, void 0, "ffwi_img"), wa(_, function(xa, ya) { qa = { type: "PNG" }, qa.src = xa, qa.w = ya.width, qa.h = ya.height }, void 0, "ffwi_legend_img"), wa(aa, function(xa, ya) { ra = { type: "PNG" }, ra.src = xa, ra.w = ya.width, ra.h = ya.height }, void 0, "umidita_img"), wa(ba, function(xa, ya) { sa = { type: "PNG" }, sa.src = xa, sa.w = ya.width, sa.h = ya.height }, void 0, "umidita_legend_img"); var va = function(xa) { z = v; var za = $("#bollettino-title")[0].innerText,
                        Aa = $("#bollettino-title-giorno")[0].innerHTML,
                        Ba = $("#bollettino-rischio").val(),
                        Ca = $("#cosa-abbiamo-avuto-label")[0].innerHTML,
                        Da = $("#cosa-ci-aspettiamo-label")[0].innerHTML,
                        Ea = $("#num-progressivo").val(),
                        Fa = $("#sinottica-text")[0].innerHTML,
                        Ga = 10,
                        Ha = $("#bollettino-abbiamo-avuto").val(),
                        Ia = $("#bollettino-ci-aspettiamo").val(),
                        Ja = $("#rischio-text")[0].innerText,
                        Ka = $("#situazione-meteo-text")[0].innerHTML,
                        La = $("#rh2mz3-11-ora-text")[0].innerHTML,
                        Ma = $("#rh2mz3-14-ora-text")[0].innerHTML,
                        Na = $("#rh2mz3-17-ora-text")[0].innerHTML,
                        Oa = $("#rh2mz3-20-ora-text")[0].innerHTML,
                        Pa = new jsPDF("p", "mm", "a4", !0),
                        Sa = 128;
                    Pa.setProperties({ title: za, subject: "Consorzio LaMMA" + " - " + "www.lamma.rete.toscana.it", author: "Consorzio LaMMA", creator: "Consorzio LaMMA" }); var Va = L(aib_logo.w, aib_logo.h, 60);
                    Pa.addImage(aib_logo.src, "PNG", 0, 0, 15, 15);
                    L(lamma_logo.w, lamma_logo.h, 60);
                    Pa.addImage(lamma_logo.src, "PNG", 180, 0, 30, 13), Pa.setFont("helvetica"), Pa.setFontType("bold"), Pa.setTextColor(51, 122, 183), Pa.setFontSize(12), C = J(Pa.getLineHeight(za)), z += Va.h + E + C, Pa.textAlign(za, { align: "center" }, 0, z - 35), Pa.setFontSize(Ga), Pa.setTextColor(255, 0, 0), Pa.textAlign(Aa, { align: "center" }, 0, z - 30), Pa.setTextColor(51, 122, 183), Pa.setFontSize(8), Pa.textAlign(Ea, { align: "left" }, 150, z - 30), Pa.textAlign(Ja, { align: "center" }, 0, 17); var Xa = function(tb) { switch (tb) {
                            case "BASSO":
                                return { color: I("#3CBC3D"), x: 99, w: 12 }; break;
                            case "MODERATO":
                                return { color: I("#FFE600"), x: 96, w: 18 }; break;
                            case "ALTO":
                                return { color: I("#FF7D00"), x: 100, w: 10 }; break;
                            case "MOLTO ALTO":
                                return { color: I("#C80000"), x: 95, w: 21 }; break;
                            case "ESTREMO":
                                return { color: I("#B5199D"), x: 97, w: 16 }; break;
                            default:
                        } }(Ba); if (Pa.setFillColor(Xa.color.red, Xa.color.green, Xa.color.blue), Pa.roundedRect(Xa.x, 18, Xa.w, 4, 1, 1, "F"), Pa.setTextColor(255, 255, 255), Pa.textAlign(Ba, { align: "center" }, 0, 21), Pa.setTextColor(51, 122, 183), Pa.textAlign("Indice FWI previsto per oggi", { align: "left" }, 10, 27), Pa.textAlign("(comportamento del fuoco - pericolosit\xE0 potenziale)", { align: "left" }, 10, 31), Pa.textAlign("Umidit\xE0 relativa massima registrata nella notte", { align: "right" }, 194, 27), ca) { var Ya = L(pa.w, pa.h, 100);
                        Pa.addImage(pa.src, pa.type, 10, 32, Ya.w / 1.5, Ya.h / 1.5, void 0, "FAST"); var Za = L(qa.w, qa.h, 50);
                        Pa.addImage(qa.src, qa.type, 60, 32, Za.w / 2, Za.h / 2, void 0, "FAST"); var $a = L(ra.w, ra.h, 100);
                        Pa.addImage(ra.src, ra.type, 131, 32, $a.w / 1.5, $a.h / 1.5, void 0, "FAST"); var _a = L(sa.w, sa.h, 40);
                        Pa.addImage(sa.src, sa.type, 182, 32, _a.w / 2.5, _a.h / 2.5, void 0, "FAST"); var ab = L(ca.w, ca.h, w);
                        Pa.addImage(ca.src, ca.type, 5, 195, ab.w / 2.2, ab.h / 2.2, void 0, "FAST"), z += ab.h; var bb = L(da.w, da.h, w);
                        Pa.addImage(da.src, da.type, 15, 257, bb.w / 2.8, bb.h / 2.8, void 0, "FAST"), z += bb.h; var cb = L(ea.w, ea.h, w);
                        Pa.addImage(ea.src, ea.type, 109, 195, cb.w / 2.2, cb.h / 2.2, void 0, "FAST"), z += cb.h; var db = L(fa.w, fa.h, w);
                        Pa.addImage(fa.src, fa.type, 117, 257, db.w / 2.8, db.h / 2.8, void 0, "FAST"), z += db.h } else { var eb = 80;
                        Pa.setFillColor(237), Pa.roundedRect(v, z, w, eb, 5, 5, "F"), Pa.setFontSize(60), Pa.setTextColor(255), B = "IMMAGINE", C = J(Pa.getLineHeight(B)), D = eb / 2 + C / 3, Pa.textAlign(B, { align: "center" }, 0, z + D), z += eb } if (Pa.textAlign(Ca, { align: "left" }, 3, 109), Pa.textAlign(Da, { align: "right" }, 152, 109), Fa) { Pa.setFontSize(8), Pa.setFont("helvetica"), Pa.setFontType("italic"), Pa.setTextColor(0), z = 261; var fb = 200;
                        z += v; for (var gb = 4, hb = Pa.splitTextToSize(Fa, fb), ib = 0; ib < hb.length && !window.CP.shouldStopExecution(1); ib++) Pa.text(hb[ib], 3, z), z += gb;
                        window.CP.exitedLoop(1) } if (Ha) { Pa.setFontSize(7), Pa.setFont("helvetica"), Pa.setFontType("italic"), Pa.setTextColor(Sa), z = 112; var fb = 90;
                        z += v; for (var gb = 4, hb = Pa.splitTextToSize(Ha, fb), ib = 0; ib < hb.length && !window.CP.shouldStopExecution(1); ib++) Pa.text(hb[ib], 3, z), z += gb;
                        window.CP.exitedLoop(1) } if (Ia) { Pa.setFontSize(7), Pa.setFont("helvetica"), Pa.setFontType("italic"), Pa.setTextColor(Sa), z = 112; var fb = 90;
                        z += v; for (var gb = 4, hb = Pa.splitTextToSize(Ia, fb), ib = 0; ib < hb.length && !window.CP.shouldStopExecution(1); ib++) Pa.text(hb[ib], 120, z), z += gb;
                        window.CP.exitedLoop(1) }
                    Pa.setFont("helvetica"), Pa.setFontType("bold"), Pa.setTextColor(51, 122, 183), Pa.setFontSize(8), Pa.textAlign(Ka, { align: "center" }, 0, 192), Pa.textAlign("DESCRIZIONE:", { align: "left" }, 3, 266); if (Pa.addPage(), Pa.setFont("helvetica"), Pa.setFontType("bold"), Pa.addImage(aib_logo.src, "PNG", 0, 0, 15, 15), Pa.addImage(lamma_logo.src, "PNG", 180, 0, 30, 13), Pa.setTextColor(51, 122, 183), Pa.setFontSize(12), Pa.textAlign(za, { align: "center" }, 0, 5), Pa.setFontSize(Ga), Pa.setTextColor(255, 0, 0), Pa.textAlign(Aa, { align: "center" }, 0, 10), Pa.setTextColor(51, 122, 183), Pa.setFontSize(8), Pa.textAlign(Ka, { align: "center" }, 0, 16), z += E, ca) { var kb = L(ga.w, ga.h, w);
                        Pa.addImage(ga.src, ga.type, 5, 26, kb.w / 2.2, kb.h / 2.2, void 0, "FAST"), z += kb.h; var lb = L(ha.w, ha.h, w);
                        Pa.addImage(ha.src, ha.type, 14, 98, lb.w / 2.7, lb.h / 2.7, void 0, "FAST"), z += lb.h; var mb = L(ia.w, ia.h, w);
                        Pa.addImage(ia.src, ia.type, 111, 26, mb.w / 2.2, mb.h / 2.2, void 0, "FAST"), z += mb.h; var nb = L(ja.w, ja.h, w);
                        Pa.addImage(ja.src, ja.type, 120, 97, nb.w / 2.7, nb.h / 2.7, void 0, "FAST"), z += nb.h, Pa.textAlign(La, { align: "left" }, 45, 110), Pa.textAlign(Ma, { align: "left" }, 150, 110); var ob = L(ka.w, ka.h, w);
                        Pa.addImage(ka.src, ka.type, 0, 112, ob.w / 2, ob.h / 2, void 0, "FAST"), z += ob.h; var pb = L(la.w, la.h, w);
                        Pa.addImage(la.src, la.type, 106, 112, pb.w / 2, pb.h / 2, void 0, "FAST"), z += pb.h, Pa.textAlign(Na, { align: "left" }, 45, 204), Pa.textAlign(Oa, { align: "left" }, 150, 204); var qb = L(oa.w, oa.h, 70);
                        Pa.addImage(oa.src, oa.type, 90, 192, qb.w / 2.2, qb.h / 2.2, void 0, "FAST"), z += qb.h; var rb = L(ma.w, ma.h, w);
                        Pa.addImage(ma.src, ma.type, 0, 206, rb.w / 2, rb.h / 2, void 0, "FAST"), z += rb.h; var sb = L(na.w, na.h, w);
                        Pa.addImage(na.src, na.type, 106, 206, sb.w / 2, sb.h / 2, void 0, "FAST"), z += sb.h }
                    xa ? G.attr("src", Pa.output("datauristring")) : (Pa.save(za + " " + n + ".pdf"), H.prop("disabled", !1), waitingDialog.hide()) };
                $("#flyer_download_btn").on("click", function() { H.prop("disabled", !0), waitingDialog.show("Creazione PDF in corso...", { dialogSize: "sm", progressType: "warning" }), setTimeout(function() { va(!1) }, 1e3) }) } catch (wa) { console.log(wa) } } }, b.send() }();